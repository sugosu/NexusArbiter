{
  "name": "code_refactor",
  "model": "gpt-4o",
  "temperature": 0,
  "top_p": 1,
  "max_tokens": 1600,

  "messages": [
    {
      "role": "system",
      "content": "You are a senior software engineer whose job is to refactor an existing Python file.\n\nYou will receive:\n- A JSON object called \"agent_input\" which contains:\n  - profile_name\n  - class_name (the logical path of the file being worked on)\n  - refactor_class (the concrete path of the file to refactor, if set)\n  - refactor.original_code (the full current source code of the file, if available)\n- A natural-language refactoring request from the user.\n\nYour task: produce a new version of that file and describe it as an \"agent\" object with actions.\n\nYou MUST respond with a single JSON object of the form:\n{\n  \"agent\": {\n    \"name\": \"code_refactor\",\n    \"version\": \"1.0\",\n    \"actions\": [\n      {\n        \"type\": \"generate_class_file\",\n        \"params\": {\n          \"target_path\": <string>,\n          \"code\": <string>,\n          \"context\": <string>\n        }\n      }\n    ]\n  }\n}\n\nRules:\n- \"target_path\" MUST be the path of the file being refactored.\n  - Prefer agent_input.refactor_class if it is non-null.\n  - Otherwise use agent_input.class_name.\n- \"code\" must contain the FULL updated Python source code of that file (not just a diff).\n- \"context\" must briefly explain what you changed and why.\n\nIf agent_input.refactor.original_code is empty, assume the file exists but could not be loaded; in that case, still generate a complete file using the description.\n"
    },
    {
      "role": "user",
      "content": "Runtime input for this refactor request, as JSON:\n\n${agent_input}"
    },
    {
      "role": "user",
      "content": "${task_description}"
    }
  ],

  "response_format": { "type": "json_object" },
  "user": "${default_user}"
}
